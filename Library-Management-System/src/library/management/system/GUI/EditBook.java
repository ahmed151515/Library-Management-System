/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package library.management.system.GUI;


import library.management.system.Book;
import library.management.system.Database;

import javax.swing.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.LinkedList;

import static com.sun.java.accessibility.util.AWTEventMonitor.addActionListener;

/**
 * @author Ahmed
 */
public class EditBook extends javax.swing.JPanel {
		private static int book_id;
	/**
	 * Creates new form AddBook
	 */
	public EditBook() {
		initComponents();
	}

	/**
	 * This method is called from within the constructor to initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is always
	 * regenerated by the Form Editor.
	 */
	@SuppressWarnings("unchecked")
	// <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
	private void initComponents() {
		java.awt.GridBagConstraints gridBagConstraints;

		jPopupMenu1 = new javax.swing.JPopupMenu();
		Author = new javax.swing.JTextField();
		Category = new javax.swing.JTextField();
		num_page = new javax.swing.JTextField();
		Description = new javax.swing.JTextField();
		EditBookLabel = new javax.swing.JLabel();
		BackButton = new javax.swing.JButton();
		SendButton = new javax.swing.JButton();
		BookNameL = new javax.swing.JLabel();
		AuthorL = new javax.swing.JLabel();
		CategoryL = new javax.swing.JLabel();
		BookPagesNumberL = new javax.swing.JLabel();
		DescriptionL = new javax.swing.JLabel();
		bookname = new javax.swing.JTextField();

		setLayout(new java.awt.GridBagLayout());
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 5;
		gridBagConstraints.gridwidth = 7;
		gridBagConstraints.ipadx = 436;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(6, 209, 0, 263);
		add(Author, gridBagConstraints);

		Category.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				CategoryActionPerformed(evt);
			}
		});
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 7;
		gridBagConstraints.gridwidth = 7;
		gridBagConstraints.ipadx = 436;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(6, 209, 0, 263);
		add(Category, gridBagConstraints);

		num_page.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jTextField4ActionPerformed(evt);
			}
		});
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 9;
		gridBagConstraints.gridwidth = 7;
		gridBagConstraints.ipadx = 436;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(6, 209, 0, 263);
		add(num_page, gridBagConstraints);

		Description.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				DescriptionActionPerformed(evt);
			}
		});
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 11;
		gridBagConstraints.gridwidth = 7;
		gridBagConstraints.ipadx = 436;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(6, 209, 0, 263);
		add(Description, gridBagConstraints);

		EditBookLabel.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N
		EditBookLabel.setText("Edit Book");
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 5;
		gridBagConstraints.gridy = 1;
		gridBagConstraints.gridwidth = 2;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(38, 84, 0, 0);
		add(EditBookLabel, gridBagConstraints);

		BackButton.setText("<<<");
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 0;
		gridBagConstraints.gridy = 1;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(6, 6, 0, 0);
		add(BackButton, gridBagConstraints);
		BackButton.addActionListener(new ActionListener() {
			@Override
			public void actionPerformed(ActionEvent e) {
				Back(e);
			}
		});
		SendButton.setText("send");
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 5;
		gridBagConstraints.gridy = 12;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(50, 109, 22, 0);
		add(SendButton, gridBagConstraints);
		SendButton.addActionListener(new java.awt.event.ActionListener() {
			@Override
			public void actionPerformed(ActionEvent e) {
				Send(e);
			}
		});

		BookNameL.setText("Book Name");
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 2;
		gridBagConstraints.gridwidth = 3;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(87, 209, 0, 0);
		add(BookNameL, gridBagConstraints);

		AuthorL.setText("Author");
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 4;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(50, 209, 0, 0);
		add(AuthorL, gridBagConstraints);

		CategoryL.setText("Category");
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 6;
		gridBagConstraints.gridwidth = 2;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(50, 209, 0, 0);
		add(CategoryL, gridBagConstraints);

		BookPagesNumberL.setText("Book Pages Number");
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 8;
		gridBagConstraints.gridwidth = 4;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(50, 209, 0, 0);
		add(BookPagesNumberL, gridBagConstraints);

		DescriptionL.setText("Description");
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 10;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(50, 209, 0, 0);
		add(DescriptionL, gridBagConstraints);
		gridBagConstraints = new java.awt.GridBagConstraints();
		gridBagConstraints.gridx = 1;
		gridBagConstraints.gridy = 3;
		gridBagConstraints.gridwidth = 7;
		gridBagConstraints.ipadx = 436;
		gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
		gridBagConstraints.insets = new java.awt.Insets(6, 209, 0, 263);
		add(bookname, gridBagConstraints);
	}// </editor-fold>//GEN-END:initComponents

	private void jTextField4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField4ActionPerformed
		// TODO add your handling code here:
	}//GEN-LAST:event_jTextField4ActionPerformed

	private void DescriptionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_DescriptionActionPerformed
		// TODO add your handling code here:
	}//GEN-LAST:event_DescriptionActionPerformed

	private void CategoryActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CategoryActionPerformed
		// TODO add your handling code here:
	}
	private void Back(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CategoryActionPerformed
		GUI.cardLayout.show(GUI.frame.getContentPane(), "nAdminGui");
	}
// -------------------------------------------------------------------------------

	private void Send(java.awt.event.ActionEvent e) {
		try {
			Book book = new Book(
					bookname.getText()
					, Integer.parseInt(num_page.getText())
					, new ArrayList<>(Arrays.asList(Category.getText().split(",\\s*")))
					, Author.getText()
					, Description.getText()
					, NLogin.user_id
			);
			book.setBook_id(EditBook.book_id);
			int result = book.update();
			if (result > 0) {
				JOptionPane.showMessageDialog(GUI.frame, "The book has been successfully Edited");
				NAdminGui.refresh(book_id);
			} else {
				JOptionPane.showMessageDialog(GUI.frame, "Failed to add the book");

			}
		} catch (NumberFormatException ee) {
			JOptionPane.showMessageDialog(GUI.frame
					, "number Page ()"
							+ num_page.getText()
							+ "must is number ", "WARNING"
					, JOptionPane.WARNING_MESSAGE);
		} catch (SQLException ee) {
			throw new RuntimeException(ee);
		}
	}

	public static void setData(int book_ID) throws SQLException {
		EditBook.book_id = book_ID;
		ResultSet rs = Database.select_stmt("*", "books", "book_Id = " + book_ID);
		if (rs.next()) {
			bookname.setText(rs.getString("book_name"));
			Category.setText(Book.getBookCategories(book_ID));
			Description.setText(rs.getString("book_descnbtion"));
			num_page.setText(rs.getString("num_page"));
			Author.setText(rs.getString("book_author"));
		}
		rs.close();
		Database.close_stmt();
	}
// -------------------------------------------------------------------------------


	// Variables declaration - do not modify//GEN-BEGIN:variables
	private static javax.swing.JTextField Author;
	private static javax.swing.JTextField bookname;
	private javax.swing.JLabel AuthorL;
	private javax.swing.JButton BackButton;
	private javax.swing.JLabel BookNameL;
	private javax.swing.JLabel BookPagesNumberL;
	private static javax.swing.JTextField Category;
	private javax.swing.JLabel CategoryL;
	private static javax.swing.JTextField Description;
	private javax.swing.JLabel DescriptionL;
	private javax.swing.JLabel EditBookLabel;
	private javax.swing.JButton SendButton;
	private javax.swing.JPopupMenu jPopupMenu1;
	private static javax.swing.JTextField num_page;
	// End of variables declaration//GEN-END:variables
}